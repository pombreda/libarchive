#summary Using git-svn with libarchive repository.

= Introduction =

It is often desirable to be able to use another SCM other than svn to make changes to libarchive's source. This page is a simple HOWTO for setting up a git repo that can be used to track changes made in libarchive's svn repository, to include tracking the tags and branches placed in non-standard locations.

= Details =

1. Make a directory where the libarchive source tree is to be placed and change into that directory.
{{{
mkdir libarchive
cd libarchive
}}}

2. Initialize the new directory as a git repository to track libarchive svn repository using git-svn.
{{{
git svn init --stdlayout http://libarchive.googlecode.com/svn
}}}
NOTE: If you're a dev, use the following command instead.
{{{
git svn init --stdlayout https://libarchive.googlecode.com/svn --username=<googlecode_username>
}}}

3. Change the git config setting for tracking libarchive's tag to point to the "release" directory in libarchive's svn repository.
{{{
git config svn-remote.svn.tags release/*:refs/tags/release/*
}}}

4. Because there is at least one branch that is not in a standard location, each individual branch has to be tracked via individual "fetch" config options. Thus, remove the "branches" config option and add "fetch" config options for each branch.
{{{
git config --unset svn-remote.svn.branches
git config --add svn-remote.svn.fetch branches/ferringb-workspace/libarchive:refs/remotes/ferringb-workspace-libarchive
git config --add svn-remote.svn.fetch branches/multivolume:refs/remotes/multivolume
git config --add svn-remote.svn.fetch branches/nfs4:refs/remotes/nfs4
git config --add svn-remote.svn.fetch branches/pax_fe:refs/remotes/pax_fe
git config --add svn-remote.svn.fetch branches/rseek:refs/remotes/rseek
}}}

5. Check your git configuration before proceeding. Your git configuration should look like this.
{{{
git config -l
...[snip]...
svn-remote.svn.url=http://libarchive.googlecode.com/svn
svn-remote.svn.fetch=trunk:refs/remotes/trunk
svn-remote.svn.tags=release/*:refs/tags/release/*
svn-remote.svn.fetch=branches/ferringb-workspace/libarchive:refs/remotes/ferringb-workspace-libarchive
svn-remote.svn.fetch=branches/multivolume:refs/remotes/multivolume
svn-remote.svn.fetch=branches/nfs4:refs/remotes/nfs4
svn-remote.svn.fetch=branches/pax_fe:refs/remotes/pax_fe
svn-remote.svn.fetch=branches/rseek:refs/remotes/rseek
}}}

6. Once you verified the git repository is setup properly, fetch the sources.
{{{
git svn fetch
}}}

7. Check that all branches and tags were fetched.
{{{
git branch -a
* master
  remotes/ferringb-workspace-libarchive
  remotes/multivolume
  remotes/nfs4
  remotes/pax_fe
  remotes/rseek
  remotes/trunk
git tag -l
release/2.6
release/2.7
release/2.8
release/3.0
}}}